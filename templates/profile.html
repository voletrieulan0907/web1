{% extends "base.html" %}

{% block title %}Profile - MMO Pro Store{% endblock %}

{% block content %}
<section class="profile-section">
    <div class="profile-container">
        <!-- User Info Card -->
        <div class="profile-card">
            <div class="profile-header">
                <div class="profile-avatar">üë§</div>
                <div class="profile-info">
                    <h2>{{ user.username }}</h2>
                    <p>{{ user.email }}</p>
                </div>
            </div>
            <div class="profile-stats">
                <div class="stat-item">
                    <div class="stat-number">{{ "{:,}".format(user.balance or 0) }}</div>
                    <div class="stat-label">S·ªë d∆∞ (VNƒê)</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">{{ purchases|length }}</div>
                    <div class="stat-label">S·∫£n ph·∫©m ƒë√£ mua</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number">{{ purchases|sum(attribute='download_count') }}</div>
                    <div class="stat-label">L∆∞·ª£t t·∫£i</div>
                </div>
            </div>
            <div class="profile-actions">
                <a href="{{ url_for('recharge') }}" class="action-button">üí∞ N·∫°p ti·ªÅn</a>
                <a href="#" class="action-button">‚öôÔ∏è C√†i ƒë·∫∑t</a>
            </div>
        </div>

        <!-- Purchase History -->
        <div class="purchases-section">
            <h3>L·ªãch S·ª≠ Mua H√†ng</h3>
            {% if purchases %}
                <div class="purchases-grid">
                    {% for purchase in purchases %}
                    <div class="purchase-card">
                        <div class="purchase-header">
                            <span class="product-icon">{{ purchase.icon }}</span>
                            <div class="purchase-info">
                                <h4>{{ purchase.name }}</h4>
                                <p class="purchase-date">{{ purchase.purchase_date[:16] }}</p>
                            </div>
                            <div class="purchase-price">{{ "{:,}".format(purchase.price) }} VNƒê</div>
                        </div>
                        <!-- ...trong purchases-grid... -->
                        <div class="purchase-stats">
                            <span class="download-count">ƒê√£ t·∫£i: {{ purchase.download_count }} l·∫ßn</span><br>
                            <span class="purchase-key">üîë Key: <b>{{ purchase.key }}</b></span>
                        </div>
                        <div class="purchase-actions">
                            <a href="{{ url_for('download_product', purchase_id=purchase.id) }}" 
                               class="download-button">‚¨áÔ∏è T·∫£i xu·ªëng</a>
                            <a href="{{ url_for('product_detail', product_id=purchase.product_id) }}" 
                               class="info-button">‚ÑπÔ∏è Chi ti·∫øt</a>
                        </div>
                    </div>
                    
                    {% endfor %}
                </div>
            {% else %}
                <div class="empty-state">
                    <div class="empty-icon">üõí</div>
                    <h4>Ch∆∞a c√≥ s·∫£n ph·∫©m n√†o</h4>
                    <p>H√£y kh√°m ph√° v√† mua s·∫£n ph·∫©m ƒë·∫ßu ti√™n c·ªßa b·∫°n!</p>
                    <a href="{{ url_for('home') }}#products" class="cta-button">Xem s·∫£n ph·∫©m</a>
                </div>
            {% endif %}
        </div>

        <!-- Quick Actions -->
        <div class="quick-actions">
            <h3>Thao T√°c Nhanh</h3>
            <div class="actions-grid">
                <div class="action-card">
                    <div class="action-icon">üîÑ</div>
                    <h4>C·∫≠p nh·∫≠t ph·∫ßn m·ªÅm</h4>
                    <p>Ki·ªÉm tra phi√™n b·∫£n m·ªõi nh·∫•t</p>
                    <button class="action-btn">Ki·ªÉm tra</button>
                </div>
                <div class="action-card">
                    <div class="action-icon">üí¨</div>
                    <h4>H·ªó tr·ª£ k·ªπ thu·∫≠t</h4>
                    <p>Li√™n h·ªá team support</p>
                    <button class="action-btn">Chat ngay</button>
                </div>
                <div class="action-card">
                    <div class="action-icon">üìñ</div>
                    <h4>H∆∞·ªõng d·∫´n s·ª≠ d·ª•ng</h4>
                    <p>Xem tutorial v√† tips</p>
                    <button class="action-btn">Xem ngay</button>
                </div>
            </div>
        </div>
    </div>
</section>
{% endblock %}